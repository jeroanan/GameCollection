var Platforms=function(a,b){this.ajax=a,this.urls=b};Platforms.prototype.addPlatform=function(a,b){var c=$.Deferred(),d=this.ajax||new Ajax,e={name:a,description:b},f=d.validateNameDescription(e);return"fail"===f.result?c.reject(f.fields):d.addNameDescription(urls.addplatform,a,b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c},Platforms.prototype.addNewPlatform=function(){var a=$.Deferred(),b={name:$("#name").val(),description:$("#description").val()},c=this.ajax.validateNameDescription(b);return"fail"===c.result?a.reject({fields:c.fields}):this.ajax.addNewNameDescription(this.addPlatform).done(function(b){a.resolve(b)}).fail(function(b){a.reject(b)}),a},Platforms.prototype.deletePlatform=function(){var a=$.Deferred();return this.ajax.ajaxDelete(urls.deleteplatform,this.ajax.getIdJson()).done(function(b){a.resolve(b)}).fail(function(b){a.reject(b)}),a},Platforms.prototype.updatePlatform=function(){var a=$.Deferred();return this.ajax.updateNameDescription(urls.updateplatform).done(function(b){a.resolve(b)}).fail(function(b){a.reject(b)}),a},$(function(){var a=new Ajax,b=new Platforms(a,urls),c="platform",d=function(b){if(b.result){var c=b.result;"already_exists"===c?a.showValidationFailure("A platform with this name already exists"):"not_found"===c?a.showValidationFailure("Unknown platform"):"validation_failed"===c?a.showValidationFailure("Please enter a platform name and description"):"ok"===c?document.location=urls.platforms:a.showValidationFailure("An error occurred while adding the platform")}};$("input.addnewplatform").on("click",function(e){var f=$("input.addnewplatform"),g="new-platform-loading-gif",h=$("input");e.preventDefault(),doLoading(f,g,h),a.hideValidationFailure(),b.addNewPlatform().done(function(a){var b=JSON.parse(a);d(b)}).fail(function(b){b.fields?showFailure(b.fields,c):a.showValidationFailure("An error occurred while adding the platform")}).always(function(){finishedLoading(g,h)})}),$("button.addsuggestedplatform").on("click",function(a){var c=a.currentTarget.attributes["data-index"].value,d=$("td.suggestedplatformname-"+c).text(),e=$("td.suggestedplatformdescription-"+c).text(),f=$("button.addsuggestedplatform-"+c),g="suggested-platform-loading-gif";return a.preventDefault(),doLoading(f,g),f.attr("disabled","true"),b.addPlatform(d,e).done(function(){document.location.reload()}).always(function(){finishedLoading(g)}),!1}),$("input.saveButton").on("click",function(c){var e=$(".saveButton"),f="save-platform-loading-gif",g=$("form").find("input");return c.preventDefault(),a.hideValidationFailure(),doLoading(e,f,g),b.updatePlatform().done(function(a){var b=JSON.parse(a);d(b)}).fail(function(a){a.fields&&showFailure(a.fields)}).always(function(){finishedLoading(f,g)}),!1}),$("a.yesDelete").on("click",function(a){var c=$("form").find("input"),e=$("a.yesDelete"),f="delete-platform-loading-gif";return a.preventDefault(),doLoading(e,f,c),b.deletePlatform().done(function(a){var b=JSON.parse(a);d(b)}).always(function(){finishedLoading(f,c)}),!1}),"/editplatform"===document.location.pathname&&$("#name").focus()});
//# sourceMappingURL=script.min.js.map