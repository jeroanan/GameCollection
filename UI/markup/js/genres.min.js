var Genres=function(a,b){this.ajaxFunctions=a,this.urls=b};Genres.prototype.addGenre=function(a,b){var c=$.Deferred(),d=this.ajaxFunctions||new Ajax,e={name:a,description:b},f=d.validateNameDescription(e);return"fail"===f.result?c.reject(f.fields):d.addNameDescription(this.urls.addgenre,a,b).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c},Genres.prototype.addNewGenre=function(){var a=$.Deferred(),b={name:$("#name").val(),description:$("#description").val()},c=this.ajaxFunctions.validateNameDescription(b);return"fail"===c.result?a.reject({fields:c.fields}):this.ajaxFunctions.addNewNameDescription(this.addGenre).done(function(b){a.resolve(b)}).fail(function(b){a.reject(b)}),a},Genres.prototype.deleteGenre=function(){var a=$.Deferred();return this.ajaxFunctions.ajaxDelete(this.urls.deletegenre,this.ajaxFunctions.getIdJson()).done(function(b){a.resolve(b)}).fail(function(b){a.reject(b)}),a},Genres.prototype.updateGenre=function(){var a=$.Deferred(),b=this.ajaxFunctions||new Ajax;return b.updateNameDescription(urls.updategenre).done(function(b){a.resolve(b)}).fail(function(b){a.reject(b)}),a},$(function(){var a=new Ajax,b=new Genres(a,urls),c=function(a,b){$("."+a).remove(),b.removeAttr("disabled")};$(".addnewgenre").on("click",function(a){var d=$(".addnewgenre"),e="add-new-genre-lonading-gif",f=$("form").find("input");return a.preventDefault(),addLoadingGif(d,e),f.attr("disabled","true"),b.addNewGenre().done(function(){document.location.reload()}).fail(function(a){a.fields&&showFailure(a.fields,"genre")}).always(function(){c(e,f)}),!1}),$("a.yesDelete").on("click",function(a){var d=$("a.yesDelete"),e="delete-genre-loading-gif",f=$("form").find("input");return a.preventDefault(),addLoadingGif(d,e),f.attr("disabled","true"),b.deleteGenre().done(function(){document.location=urls.genres}).always(function(){c(e,f)}),!1}),$("button.addSuggestedGenre").on("click",function(a){var d=a.currentTarget.attributes["data-index"].value,e=$("td.genreName-"+d).text(),f=$("td.genreDescription-"+d).text(),g=$("button.addSuggestedGenre-"+d),h="add-suggested-genre-loading-gif-"+d;return addLoadingGif(g,h),g.attr("disabled","true"),b.addGenre(e,f).done(function(){document.location.reload()}).always(function(){c(h,g)}),!1}),$("input.saveButton").on("click",function(a){a.preventDefault(),hideValidationFailure();var d=$("input.saveButton"),e="save-button-loading-gif",f=$("form").find("input");addLoadingGif(d,e),f.attr("disabled","true"),b.updateGenre().done(function(){document.location=urls.genres}).fail(function(a){a.fields&&showFailure(a.fields,"genre")}).always(function(a){c(e,f)})}),"/editgenre"===document.location.pathname&&$("#name").focus()});
//# sourceMappingURL=script.min.js.map